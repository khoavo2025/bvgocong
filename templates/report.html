{% extends "base.html" %}
{% block content %}

<style>
.dashboard {
    position: relative;
    width: 100%;
    height: 80vh;
    min-height: 600px;
}

.center-box {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: #0f4c75;
    color: #fff;
    padding: 30px 40px;
    border-radius: 16px;
    text-align: center;
    box-shadow: 0 10px 30px rgba(0,0,0,.25);
    z-index: 10;
}

.center-box h3 {
    margin-bottom: 8px;
    font-weight: 700;
}

.center-box p {
    font-size: 14px;
    opacity: .9;
    color: #fff;
}

.dept {
    position: absolute;
    width: 200px;
    background: #ffffff;
    border-radius: 14px;
    padding: 14px;
    box-shadow: 0 6px 16px rgba(0,0,0,.12);
    transition: transform .2s ease, box-shadow .2s ease;
}

.dept:hover {
    transform: translateY(-4px);
    box-shadow: 0 10px 22px rgba(0,0,0,.18);
}

.dept h6 {
    font-weight: 600;
    margin-bottom: 6px;
}

.dept small {
    color: #6b7280;
}

.dept .alert {
    font-size: 12px;
    padding: 4px 8px;
    margin-top: 6px;
}

/* Vá»Š TRÃ KHOA */
.dept.hscc      { top: 0%; left: 50%; transform: translate(-50%, 0); }
.dept.san       { top: 15%; right: 10%; }
.dept.nhi       { top: 50%; right: 0%; transform: translateY(-50%); }
.dept.noitim    { bottom: 15%; right: 10%; }
.dept.gmhs      { bottom: 0%; left: 50%; transform: translate(-50%, 0); }
.dept.khth      { bottom: 15%; left: 10%; }
.dept.dieuduong { top: 50%; left: 0%; transform: translateY(-50%); }
.dept.cntt      { top: 15%; left: 10%; }
.dept.ketoan    { top: 35%; left: 50%; transform: translateX(-50%); }
.dept.tchc      { bottom: 35%; left: 50%; transform: translateX(-50%); }
/* ===== Bá»” SUNG KHOA â€“ PHÃ‚N Bá» THEO GÃ“C TRÃ’N ===== */

/* Giá»¯a HSCC (0Â°) vÃ  Sáº£n (45Â°) */
.dept.noitonghop { top: 8%; right: 25%; }

/* Giá»¯a Sáº£n (45Â°) vÃ  Nhi (90Â°) */
.dept.nhiem      { top: 28%; right: 22%; }

/* Giá»¯a Nhi (90Â°) vÃ  Ná»™i tim máº¡ch (135Â°) */
.dept.duoc       { bottom: 28%; right: 22%; }

/* Giá»¯a Ná»™i tim máº¡ch (135Â°) vÃ  GMHS (180Â°) */
.dept.xetnghiem  { bottom: 8%; right: 25%; }

/* Giá»¯a GMHS (180Â°) vÃ  KHTH (225Â°) */
.dept.cdha       { bottom: 8%; left: 25%; }

/* Giá»¯a KHTH (225Â°) vÃ  Äiá»u dÆ°á»¡ng (270Â°) */
.dept.vattuyte   { bottom: 28%; left: 22%; }

/* Giá»¯a Äiá»u dÆ°á»¡ng (270Â°) vÃ  CNTT (315Â°) */
.dept.ksnk       { top: 28%; left: 22%; }

/* Giá»¯a CNTT (315Â°) vÃ  HSCC (360Â°) */
.dept.dinhduong  { top: 8%; left: 25%; }

/* VÃ²ng trong â€“ há»— trá»£ chá»©c nÄƒng */
.dept.vatlytl    { top: 50%; left: 50%; transform: translate(-50%, -120%); }
/* Khoa Ngoáº¡i â€“ náº±m trÃªn Ná»™i tá»•ng há»£p vÃ  Sáº£n */
.dept.ngoai {
    top: 1%;
    right: 5%;
}




/* =========================
   RESPONSIVE â€“ MOBILE FIRST
   ========================= */

/* Tablet & Mobile */
@media (max-width: 992px) {

    .dashboard {
        position: static;
        height: auto;
        min-height: unset;
        display: flex;
        flex-direction: column;
        gap: 16px;
    }

    /* BAN GIÃM Äá»C */
    .center-box {
        position: static;
        transform: none;
        width: 100%;
        border-radius: 14px;
    }

    /* KHOA */
    .dept {
        position: static;
        width: 100%;
        transform: none !important;
    }
}

/* Mobile nhá» */
@media (max-width: 576px) {

    .dept {
        padding: 12px;
    }

    .dept h6 {
        font-size: 15px;
    }

    .center-box h3 {
        font-size: 18px;
    }

    .center-box p {
        font-size: 13px;
    }
}
.dept.disabled {
    opacity: 0.35;
    pointer-events: none;
    filter: grayscale(70%);
}

</style>

<h2 class="mb-4 text-center">ğŸ“Š Dashboard Tá»•ng Quan Bá»‡nh Viá»‡n</h2>

<div class="dashboard">

    <!-- BAN GIÃM Äá»C -->
    <div class="center-box">
        <h3>Ban GiÃ¡m Äá»‘c</h3>
        <p>Äiá»u hÃ nh & GiÃ¡m sÃ¡t toÃ n viá»‡n</p>
        <hr class="border-light">
        <div class="d-flex justify-content-between gap-3">
            <div>
                <strong>{{ report|length }}</strong><br>
                <small>Khoa</small>
            </div>
            <div>
                <strong>{{ low|length }}</strong><br>
                <small>Cáº£nh bÃ¡o</small>
            </div>
        </div>
    </div>

    <!-- HSCC -->
    <div class="dept hscc
         {% if session.role != 'admin' and session.dept != 'HSCC' %}disabled{% endif %}"
         {% if session.role == 'admin' or session.dept == 'HSCC' %}
            onclick="openDept('HSCC')"
         {% endif %}
    >
        <h6>ğŸš‘ HSCC</h6>
        <small>Há»“i sá»©c cáº¥p cá»©u</small>
        <div class="alert alert-danger mt-2">Æ¯u tiÃªn cao</div>
    </div>


    <!-- NHI -->
    <div class="dept nhi
        {% if session.role != 'admin' and session.dept != 'NHI' %}disabled{% endif %}"
         {% if session.role == 'admin' or session.dept == 'NHI' %}
            onclick="openDept('NHI')"
         {% endif %}
    >
        <h6>ğŸ¤° NHI </h6>
        <small>ChÄƒm sÃ³c tráº» em</small>
    </div>

    <!-- Sáº¢N -->
    <div class="dept san
        {% if session.role != 'admin' and session.dept != 'SAN' %}disabled{% endif %}"
         {% if session.role == 'admin' or session.dept == 'SAN' %}
            onclick="openDept('SAN')"
         {% endif %}
    >
        <h6>ğŸ¤° Sáº£n</h6>
        <small>Sáº£n phá»¥ khoa</small>
    </div>
    <div class="dept noitim
     {% if session.role != 'admin' and session.dept != 'NTM' %}disabled{% endif %}"
     {% if session.role == 'admin' or session.dept == 'NTM' %}
        onclick="openDept('NTM')"
     {% endif %}
    >
    <h6>ğŸ«€ Ná»™i tim máº¡ch</h6>
    <small>ChuyÃªn khoa tim máº¡ch</small>
    </div>

    <div class="dept gmhs
     {% if session.role != 'admin' and session.dept != 'GMHS' %}disabled{% endif %}"
     {% if session.role == 'admin' or session.dept == 'GMHS' %}
        onclick="openDept('GMHS')"
     {% endif %}
     >
    <h6>ğŸ’‰ GMHS</h6>
    <small>GÃ¢y mÃª há»“i sá»©c</small>
    </div>

    <div class="dept khth
     {% if session.role != 'admin' and session.dept != 'KHTH' %}disabled{% endif %}"
     {% if session.role == 'admin' or session.dept == 'KHTH' %}
        onclick="openDept('KHTH')"
     {% endif %}
    >
    <h6>ğŸ“‹ Káº¿ hoáº¡ch tá»•ng há»£p</h6>
    <small>Äiá»u phá»‘i & thá»‘ng kÃª</small>
    </div>

    <div class="dept cntt
     {% if session.role != 'admin' and session.dept != 'CNTT' %}disabled{% endif %}"
     {% if session.role == 'admin' or session.dept == 'CNTT' %}
        onclick="openDept('CNTT')"
     {% endif %}
    >
    <h6>ğŸ–¥ï¸ CNTT</h6>
    <small>CÃ´ng nghá»‡ thÃ´ng tin</small>
    </div>

    <div class="dept khambenh
     {% if session.role != 'admin' and session.dept != 'KB' %}disabled{% endif %}"
     {% if session.role == 'admin' or session.dept == 'KB' %}
        onclick="openDept('KB')"
     {% endif %}
    >
    <h6>ğŸ©º KhÃ¡m bá»‡nh</h6>
    <small>Tiáº¿p nháº­n & sÃ ng lá»c</small>
    </div>

    <div class="dept dieuduong
     {% if session.role != 'admin' and session.dept != 'DD' %}disabled{% endif %}"
     {% if session.role == 'admin' or session.dept == 'DD' %}
        onclick="openDept('DD')"
     {% endif %}
    >
    <h6>ğŸ‘©â€âš•ï¸ Äiá»u dÆ°á»¡ng</h6>
    <small>Quáº£n lÃ½ Ä‘iá»u dÆ°á»¡ng</small>
    </div>

    <div class="dept ketoan
     {% if session.role != 'admin' and session.dept != 'KT' %}disabled{% endif %}"
     {% if session.role == 'admin' or session.dept == 'KT' %}
        onclick="openDept('KT')"
     {% endif %}
    >
    <h6>ğŸ’° Káº¿ toÃ¡n</h6>
    <small>TÃ i chÃ­nh â€“ káº¿ toÃ¡n</small>
    </div>

    <div class="dept tchc
     {% if session.role != 'admin' and session.dept != 'TCHC' %}disabled{% endif %}"
     {% if session.role == 'admin' or session.dept == 'TCHC' %}
        onclick="openDept('TCHC')"
     {% endif %}
    >
    <h6>ğŸ›ï¸ Tá»• chá»©c hÃ nh chÃ¡nh</h6>
    <small>NhÃ¢n sá»± & hÃ nh chÃ­nh</small>
    </div>


    <!-- NGOáº I -->
    <div class="dept ngoai
     {% if session.role != 'admin' and session.dept != 'NG' %}disabled{% endif %}"
     {% if session.role == 'admin' or session.dept == 'NG' %}
        onclick="openDept('NG')"
     {% endif %}
    >
    <h6>ğŸ”ª Ngoáº¡i</h6>
    <small>Pháº«u thuáº­t â€“ can thiá»‡p</small>
    </div>


    <!-- Ná»˜I Tá»”NG Há»¢P -->
    <div class="dept noitonghop
     {% if session.role != 'admin' and session.dept != 'NTH' %}disabled{% endif %}"
     {% if session.role == 'admin' or session.dept == 'NTH' %}
        onclick="openDept('NTH')"
     {% endif %}
    >
    <h6>ğŸ« Ná»™i tá»•ng há»£p</h6>
    <small>Äiá»u trá»‹ ná»™i khoa</small>
    </div>
    <!-- Váº¬T TÆ¯ THIáº¾T Bá»Š Y Táº¾ -->
    <div class="dept vattuyte
     {% if session.role != 'admin' and session.dept != 'VTYT' %}disabled{% endif %}"
     {% if session.role == 'admin' or session.dept == 'VTYT' %}
        onclick="openDept('VTYT')"
     {% endif %}
    >
    <h6>ğŸ§° Váº­t tÆ° â€“ TBYT</h6>
    <small>Trang thiáº¿t bá»‹ y táº¿</small>
    </div>

    <!-- DÆ¯á»¢C -->
    <div class="dept duoc
     {% if session.role != 'admin' and session.dept != 'DUOC' %}disabled{% endif %}"
     {% if session.role == 'admin' or session.dept == 'DUOC' %}
        onclick="openDept('DUOC')"
     {% endif %}
    >
    <h6>ğŸ’Š DÆ°á»£c</h6>
    <small>Quáº£n lÃ½ thuá»‘c</small>
    </div>

    <!-- XÃ‰T NGHIá»†M -->
    <div class="dept xetnghiem
     {% if session.role != 'admin' and session.dept != 'XN' %}disabled{% endif %}"
     {% if session.role == 'admin' or session.dept == 'XN' %}
        onclick="openDept('XN')"
     {% endif %}
    >
    <h6>ğŸ§ª XÃ©t nghiá»‡m</h6>
    <small>Cáº­n lÃ¢m sÃ ng</small>
    </div>

    <!-- CHáº¨N ÄOÃN HÃŒNH áº¢NH -->
    <div class="dept cdha
     {% if session.role != 'admin' and session.dept != 'CDHA' %}disabled{% endif %}"
     {% if session.role == 'admin' or session.dept == 'CDHA' %}
        onclick="openDept('CDHA')"
     {% endif %}
    >
    <h6>ğŸ©» CÄHA</h6>
    <small>Cháº©n Ä‘oÃ¡n hÃ¬nh áº£nh</small>
    </div>

    <!-- KIá»‚M SOÃT NHIá»„M KHUáº¨N -->
    <div class="dept ksnk
     {% if session.role != 'admin' and session.dept != 'KSNK' %}disabled{% endif %}"
     {% if session.role == 'admin' or session.dept == 'KSNK' %}
        onclick="openDept('KSNK')"
     {% endif %}
    >
    <h6>ğŸ§¼ KSNK</h6>
    <small>Kiá»ƒm soÃ¡t nhiá»…m khuáº©n</small>
    </div>
    
    <!-- DINH DÆ¯á» NG -->
    <div class="dept dinhduong
     {% if session.role != 'admin' and session.dept != 'DDUONG' %}disabled{% endif %}"
     {% if session.role == 'admin' or session.dept == 'DDUONG' %}
        onclick="openDept('DDUONG')"
     {% endif %}
    >
    <h6>ğŸ¥— Dinh dÆ°á»¡ng</h6>
    <small>Tiáº¿t cháº¿</small>
    </div>
    
    <!-- Váº¬T LÃ TRá»Š LIá»†U -->
    <div class="dept vatlytl
     {% if session.role != 'admin' and session.dept != 'VLTL' %}disabled{% endif %}"
     {% if session.role == 'admin' or session.dept == 'VLTL' %}
        onclick="openDept('VLTL')"
     {% endif %}
    >
    <h6>ğŸ§˜â€â™‚ï¸ VLTL</h6>
    <small>Phá»¥c há»“i chá»©c nÄƒng</small>
    </div>
    <!-- NHIá»„M -->
    <div class="dept nhiem
     {% if session.role != 'admin' and session.dept != 'NHIEM' %}disabled{% endif %}"
     {% if session.role == 'admin' or session.dept == 'NHIEM' %}
        onclick="openDept('NHIEM')"
     {% endif %}
    >
    <h6>ğŸ¦  Nhiá»…m</h6>
    <small>Bá»‡nh truyá»n nhiá»…m</small>
    <div class="alert alert-warning mt-2">Theo dÃµi</div>
    </div>


</div>
<script>
function openDept(code) {
    window.location.href = `/dashboard/khoa/${code}`;
}
</script>

{% endblock %}
