{% extends "base.html" %}
{% block title %}B√°o c√°o ƒëi·ªÅu d∆∞·ª°ng{% endblock %}

{% block content %}
<div class="d-flex gap-2 mb-3">
    <select id="monthSelect" class="form-select" style="width:150px;">
        {% for m in range(1,13) %}
        <option value="{{ m }}">Th√°ng {{ m }}</option>
        {% endfor %}
    </select>

    <select id="yearSelect" class="form-select" style="width:120px;">
        {% for y in range(2026, 2035) %}
        <option value="{{ y }}">{{ y }}</option>
        {% endfor %}
    </select>
</div>
<!-- THANH ƒêI·ªÄU H∆Ø·ªöNG -->
<div class="d-flex justify-content-between align-items-center mb-3">

    <!-- TR·ªû L·∫†I DASHBOARD KHOA -->
    <a href="/dashboard/khoa/{{ session.dept }}"
       class="btn btn-outline-secondary btn-sm">
        ‚¨Ö Tr·ªü l·∫°i khoa {{ session.dept }}
    </a>

    
</div>


<div class="card shadow-sm mb-4">
    <div class="card-body text-center">
        <h4 class="fw-bold mb-1">
            THEO D√ïI T·ª∂ L·ªÜ NG∆Ø·ªúI B·ªÜNH / ƒêI·ªÄU D∆Ø·ª†NG M·ªñI NG√ÄY
        </h4>
        <div class="text-muted" id="reportMonthYear">
            Th√°ng {{ month }}/{{ year }}
        </div>
    </div>
</div>


<div class="table-responsive">
<table class="table table-bordered text-center align-middle" style="font-size:13px;">
    <thead class="table-primary">
        <tr>
            <th rowspan="2" class="sticky-col sticky-col-1" style="min-width:60px;">STT</th>
            <th rowspan="2" class="sticky-col sticky-col-2" style="min-width:120px;">Khoa</th>
            <th rowspan="2" class="sticky-col sticky-col-3" style="min-width:150px;">N·ªôi dung</th>
            <th colspan="31">Ng√†y trong th√°ng</th>
        </tr>
        <tr >
            {% for d in range(1,32) %}
            <th class="day-col">{{ d }}</th>
            {% endfor %}
        </tr>
    </thead>

    <form method="post">
    <tbody>
    {% for khoa in data %}
        
        <tr class="table-light fw-bold">
            <td rowspan="4" class="sticky-col sticky-col-1">{{ loop.index }}</td>
            <td rowspan="4" class="sticky-col sticky-col-2">{{ khoa.name }}</td>
            <td class="sticky-col sticky-col-3 text-start">Ng∆∞·ªùi b·ªánh</td>
            {% for d in range(1,32) %}
            <td>
                <input type="number"
                       class="form-control compact autosave"
                       data-day="{{ d }}"
                       data-scope="dept"
                       data-khoa="{{ khoa.code }}"
                       data-type="patient"
                       oninput="calcDay({{ d }})">

            </td>
            {% endfor %}
        </tr>
    
        <tr>
            <td class="sticky-col sticky-col-3 text-start">ƒêi·ªÅu d∆∞·ª°ng</td>
            {% for d in range(1,32) %}
            <td>
                <input type="number"
                        class="form-control compact autosave"
                       data-day="{{ d }}"
                       data-scope="dept"
                       data-khoa="{{ khoa.code }}"
                       data-type="nurse"
                       oninput="calcDay({{ d }})">


            </td>
            {% endfor %}
        </tr>
    
        <tr>
            <td class="sticky-col sticky-col-3 text-start">Ngh·ªâ b√π / ngh·ªâ ph√©p</td>
            {% for d in range(1,32) %}
            <td>
                <input type="number"
                       class="form-control compact autosave"
                       data-day="{{ d }}"
                       data-scope="dept"
                       data-khoa="{{ khoa.code }}"
                       data-type="leave"
                       oninput="calcDay({{ d }})">



            </td>
            {% endfor %}
        </tr>
    
        <tr class="table-warning">
            <td class="sticky-col sticky-col-3 text-start fw-bold">T·ª∑ l·ªá ƒêD / BN</td>
            {% for d in range(1,32) %}
            <td>
                <input type="text"
                       class="form-control compact autosave"
                       data-day="{{ d }}"
                       data-scope="dept"
                       data-khoa="{{ khoa.code }}"
                       data-type="ratio"
                       readonly>



            </td>
            {% endfor %}
        </tr>
    {% endfor %}

<!-- ===== TO√ÄN B·ªÜNH VI·ªÜN ===== -->
<tr class="table-secondary fw-bold">
    <td rowspan="4" class="sticky-col sticky-col-1">‚Äî</td>
    <td rowspan="4" class="sticky-col sticky-col-2">TO√ÄN B·ªÜNH VI·ªÜN</td>
    <td class="sticky-col sticky-col-3 text-start">Ng∆∞·ªùi b·ªánh</td>
    {% for d in range(1,32) %}
    <td>
        <input type="number"
               class="form-control compact form-control-total"
               data-day="{{ d }}"
               data-scope="hospital"
               data-type="patient-all"
               readonly>
    </td>
    {% endfor %}
</tr>

<tr class="table-secondary fw-bold">
    <td class="sticky-col sticky-col-3 text-start">ƒêi·ªÅu d∆∞·ª°ng</td>
    {% for d in range(1,32) %}
    <td>
        <input type="number"
               class="form-control compact form-control-total"
               data-day="{{ d }}"
               data-scope="hospital"
               data-type="nurse-all"
               readonly>
    </td>
    {% endfor %}
</tr>

<tr class="table-secondary fw-bold">
    <td class="sticky-col sticky-col-3 text-start">Ngh·ªâ b√π / ngh·ªâ ph√©p</td>
    {% for d in range(1,32) %}
    <td>
        <input type="number"
               class="form-control compact form-control-total"
               data-day="{{ d }}"
               data-scope="hospital"
               data-type="leave-all"
               readonly>
    </td>
    {% endfor %}
</tr>

<tr class="table-warning fw-bold">
    <td class="sticky-col sticky-col-3 text-start">T·ª∑ l·ªá ƒêD / BN</td>
    {% for d in range(1,32) %}
    <td>
        <input type="text"
               class="form-control compact form-control-ratio"
               data-day="{{ d }}"
               data-scope="hospital"
               data-type="ratio-all"
               readonly>
    </td>
    {% endfor %}
</tr>




    </tbody>
    </table>
    
    
    </form>

</table>

</div>
<div class="text-end mt-3">
        <button class="btn btn-primary px-4">
            üíæ L∆∞u b√°o c√°o
        </button>
</div>

<script src="{{ url_for('static', filename='js/nurse-report.js') }}"></script>
{% endblock %}
